(function(e){function t(t){for(var a,i,s=t[0],c=t[1],l=t[2],m=0,d=[];m<s.length;m++)i=s[m],r[i]&&d.push(r[i][0]),r[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(d.length)d.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(a=!1)}a&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},r={app:0},o=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"00ad":function(e,t,n){"use strict";var a=n("9c96"),r=n.n(a);r.a},"034f":function(e,t,n){"use strict";var a=n("64a9"),r=n.n(a);r.a},"0a93":function(e,t,n){},"239c":function(e,t,n){},"276b":function(e,t,n){"use strict";var a=n("910d"),r=n.n(a);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),r=n("4776"),o=n.n(r),i=(n("b15b"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("sidebar"),n("sdtd-map")],1)}),s=[],c={name:"app",data:function(){return{claimTypes:["hostilefree","notify","command","leveled","reversed","normal","timed","portal","openhours","playerlevel","lcbfree"]}}},l=c,u=(n("034f"),n("2877")),m=Object(u["a"])(l,i,s,!1,null,null,null),d=m.exports,p=n("ecee"),h=n("c074"),f=n("ad3d"),v=(n("4989"),n("f9e3"),n("ab8b"),n("2dd8"),n("5f5b")),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nav",[n("sidebar-menu",{attrs:{menu:e.menu},on:{"item-click":e.onItemClick}},[n("span",{attrs:{slot:"toggle-icon"},slot:"toggle-icon"},[n("font-awesome-icon",{attrs:{icon:"arrows-alt-h",size:"xl"}})],1),n("span",{attrs:{slot:"dropdown-icon"},slot:"dropdown-icon"},[n("font-awesome-icon",{attrs:{icon:"angle-right",size:"xs"}})],1)]),n("server-settings"),n("claims"),n("commands-modal")],1)},b=[],y=(n("96cf"),n("3b8d")),x={mounted:function(){var e=Object(y["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.menu.filter(function(e){return"User"==e.title})[0],n=this.menu.filter(function(e){return"Commands"==e.title})[0],me.$on("set-commands",function(e){n.badge.text=e}),e.next=5,this.getUserStatus();case 5:this.userStatus=e.sent,this.userStatus.loggedin?(t.child.push({title:this.userStatus.username}),t.child.push({title:"Permission level: ".concat(this.userStatus.permissionlevel)}),t.child.push({href:"/session/logout",title:"Log out"})):(t.title="Log in",t.href="/session/login");case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{onItemClick:function(e,t){if(t.attributes){var n=t.attributes["v-b-modal"];if(n)return this.$bvModal.show(n)}},getUserStatus:function(){return fetch("/userstatus").then(function(e){return e.json()}).then(function(e){return e})}},data:function(){return{commands:0,userStatus:{loggedin:!1,username:null,permissionlevel:2e3,permissions:[]},menu:[{header:!0,title:"CPM Web UI",hiddenOnCollapse:!0},{title:"Connection settings",icon:{element:"font-awesome-icon",attributes:{icon:"cog"}},attributes:{"v-b-modal":"server-settings"}},{title:"Claims",icon:{element:"font-awesome-icon",attributes:{icon:"border-style"}},attributes:{"v-b-modal":"claims"}},{title:"Commands",icon:{element:"font-awesome-icon",attributes:{icon:"terminal"}},attributes:{"v-b-modal":"commands"},badge:{text:0,class:"vsm--badge_default"}},{title:"User",icon:{element:"font-awesome-icon",attributes:{icon:"user"}},child:[]},{title:"Help",icon:{element:"font-awesome-icon",attributes:{icon:"question-circle"}},child:[{href:"https://docs.csmm.app/en/CPM/",title:"Documentation",attributes:{target:"_blank"}},{href:"https://catalysm.net/discord",title:"Discord",attributes:{target:"_blank"}}]}]}}},w=x,k=Object(u["a"])(w,g,b,!1,null,null,null),_=k.exports,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"map-container"}},[n("div",{attrs:{id:"map"}},[e._v("\n    "+e._s(e.mapMessage)+"\n    "),n("div",{staticClass:"leaflet-bottom leaflet-right"},[n("b-button-group",{attrs:{size:"sm",id:"selection-control",vertical:""}},[n("b-button",{attrs:{disabled:"area"===e.selectionMode},on:{click:e.areaSelect}},[e._v("Select area")]),n("b-button",{attrs:{disabled:"region"===e.selectionMode},on:{click:e.regionSelect}},[e._v("Select region")]),n("b-button",{attrs:{variant:"danger"},on:{click:e.clearSelection}},[e._v("Clear selection")])],1)],1)])])},C=[],S=(n("7f7f"),n("ac4d"),n("8a81"),n("ac6a"),n("e11e")),z=n.n(S),L=n("5118"),M=z.a.icon({iconUrl:"img/marker-survivor.png",iconRetinaUrl:"img/marker-survivor-2x.png",iconSize:[25,48],iconAnchor:[12,24],popupAnchor:[0,-20]}),R={name:"sdtd-map",data:function(){return{map:null,tileLayer:null,layers:[],mapMessage:"Please fill in connection info in the server settings tab.",mapInfo:{regionsize:512,chunksize:16,tilesize:128,maxzoom:4},clickMarkers:[],selectedRegionsRecs:[],selectedRegions:[],selectedArea:null,claimTypes:window.claimTypes,connectionInfo:{ip:"",port:"",adminUser:"",adminToken:""},selectionMode:"area",colors:["purple","cyan","red","green","blue","yellow","orange","brown","coral","chocolate","skyblue"],colorIterator:0}},computed:{cpmPort:function(){return parseInt(this.connectionInfo.port)+1},activeColor:function(){return this.colors[this.colorIterator]}},mounted:function(){var e=this;localStorage.connectionInfo&&(this.connectionInfo=JSON.parse(localStorage.connectionInfo)),this.drawLandClaims(),this.drawPlayers(),Object(L["setInterval"])(function(){e.drawLandClaims(),e.drawPlayers()},3e4),this.createMap(),me.$on("connection-info",function(t){e.connectionInfo=t,null!=e.map&&(e.map.remove(),e.map=null,e.createMap())}),me.$on("refresh-claims",function(){null!=e.map&&(e.map.remove(),e.map=null,e.createMap())})},methods:{getLandClaims:function(){return fetch("/api/getlandclaims").then(function(e){return e.json()}).then(function(e){return e})},drawLandClaims:function(){var e=Object(y["a"])(regeneratorRuntime.mark(function e(){var t,n,a,r,o,i,s,c,l,u,m,d,p,h,f,v;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getLandClaims();case 2:t=e.sent,n=(t.claimsize-1)/2,a=this.layers["Land claim blocks"],a||(this.layers["Land claim blocks"]=new z.a.LayerGroup,a=this.layers["Land claim blocks"]),a.clearLayers(),r=!0,o=!1,i=void 0,e.prev=10,s=t.claimowners[Symbol.iterator]();case 12:if(r=(c=s.next()).done){e.next=36;break}for(l=c.value,u=!0,m=!1,d=void 0,e.prev=17,p=l.claims[Symbol.iterator]();!(u=(h=p.next()).done);u=!0)f=h.value,v=z.a.rectangle([[f.x-n,f.z-n],[f.x+n,f.z+n]]).bindPopup("".concat(l.playername," - ").concat(l.steamid," <br> Status: ").concat(l.claimactive?"Active":"Inactive")),a.addLayer(v);e.next=25;break;case 21:e.prev=21,e.t0=e["catch"](17),m=!0,d=e.t0;case 25:e.prev=25,e.prev=26,u||null==p.return||p.return();case 28:if(e.prev=28,!m){e.next=31;break}throw d;case 31:return e.finish(28);case 32:return e.finish(25);case 33:r=!0,e.next=12;break;case 36:e.next=42;break;case 38:e.prev=38,e.t1=e["catch"](10),o=!0,i=e.t1;case 42:e.prev=42,e.prev=43,r||null==s.return||s.return();case 45:if(e.prev=45,!o){e.next=48;break}throw i;case 48:return e.finish(45);case 49:return e.finish(42);case 50:return e.abrupt("return",a);case 51:case"end":return e.stop()}},e,this,[[10,38,42,50],[17,21,25,33],[26,,28,32],[43,,45,49]])}));function t(){return e.apply(this,arguments)}return t}(),getPlayers:function(){return fetch("/api/getplayersonline").then(function(e){return e.json()}).then(function(e){return e})},drawPlayers:function(){var e=Object(y["a"])(regeneratorRuntime.mark(function e(){var t,n,a,r,o,i,s,c,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getPlayers();case 2:for(t=e.sent,n=this.layers["Online players"],n||(this.layers["Online players"]=new z.a.LayerGroup,n=this.layers["Online players"]),n.clearLayers(),a=!0,r=!1,o=void 0,e.prev=9,i=t[Symbol.iterator]();!(a=(s=i.next()).done);a=!0)c=s.value,l=z.a.marker([c.position.x,c.position.z],{icon:M}).bindPopup("".concat(c.name," - ").concat(c.steamid," <br> Position: ").concat(c.position.x," ").concat(c.position.y," ").concat(c.position.z)),n.addLayer(l);e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](9),r=!0,o=e.t0;case 17:e.prev=17,e.prev=18,a||null==i.return||i.return();case 20:if(e.prev=20,!r){e.next=23;break}throw o;case 23:return e.finish(20);case 24:return e.finish(17);case 25:return e.abrupt("return",n);case 26:case"end":return e.stop()}},e,this,[[9,13,17,25],[18,,20,24]])}));function t(){return e.apply(this,arguments)}return t}(),areaSelect:function(e){z.a.DomEvent.stop(e),this.clearSelection(),this.selectionMode="area"},regionSelect:function(e){z.a.DomEvent.stop(e),this.clearSelection(),this.selectionMode="region"},clearSelection:function(e){e&&z.a.DomEvent.stop(e);var t=!0,n=!1,a=void 0;try{for(var r,o=this.clickMarkers[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;i.remove()}}catch(p){n=!0,a=p}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}this.clickMarkers=[],this.selectedArea&&this.selectedArea.remove();var s=!0,c=!1,l=void 0;try{for(var u,m=this.selectedRegionsRecs[Symbol.iterator]();!(s=(u=m.next()).done);s=!0){var d=u.value;d.remove()}}catch(p){c=!0,l=p}finally{try{s||null==m.return||m.return()}finally{if(c)throw l}}this.selectedRegions=[],me.$emit("area-selected",null),me.$emit("region-selected",this.selectedRegions)},handleRegionClick:function(){},handleAreaClick:function(){},createMap:function(){var e=this;this.mapMessage="",this.initMap(),this.initLayers(),this.map.on("click",function(t){if("area"===e.selectionMode&&(e.clickMarkers.length>1&&(e.clickMarkers[0].remove(),e.clickMarkers=e.clickMarkers.slice(1,e.clickMarkers.length)),e.clickMarkers.push(z.a.circle(t.latlng,{radius:1}).addTo(e.map)),2===e.clickMarkers.length)){var n=[e.clickMarkers[0].getLatLng(),e.clickMarkers[1].getLatLng()];e.selectedArea&&e.selectedArea.remove();var a=z.a.rectangle(n,{weight:1}).addTo(e.map);e.selectedArea=a,me.$emit("area-selected",n)}if("region"===e.selectionMode){var r=e.CoordToRegion(t.latlng),o=e.FormatRegionFileName(r),i={W:r.lat*e.mapInfo.regionsize,E:r.lat*e.mapInfo.regionsize+e.mapInfo.regionsize,N:r.lng*e.mapInfo.regionsize+e.mapInfo.regionsize,S:r.lng*e.mapInfo.regionsize,Name:o,Type:"To be confirmed reset region"},s=e.createClaimRectangle(i,"Selected region","grey");s.addTo(e.map),e.selectedRegionsRecs.push(s),e.selectedRegions.push(o),me.$emit("region-selected",e.selectedRegions)}})},GetSdtdTileLayer:function(e){var t=z.a.tileLayer("".concat(window.allocsMap.protocol,"//").concat(window.allocsMap.host,":").concat(window.allocsMap.port,"/map/{z}/{x}/{y}.png?adminUser={adminUser}&adminToken={adminToken}"),{maxZoom:e.maxzoom+1,minZoom:Math.max(0,e.maxzoom-5),maxNativeZoom:e.maxzoom,minNativeZoom:0,tileSize:e.tilesize,adminUser:this.connectionInfo.adminUser,adminToken:this.connectionInfo.adminToken});return t.getTileUrl=function(e){return e.y=-e.y-1,z.a.TileLayer.prototype.getTileUrl.bind(t)(e)},t},initMap:function(){var e=this.mapInfo,t={project:function(t){return new z.a.Point(t.lat/Math.pow(2,e.maxzoom),t.lng/Math.pow(2,e.maxzoom))},unproject:function(t){return new z.a.LatLng(t.x*Math.pow(2,e.maxzoom),t.y*Math.pow(2,e.maxzoom))}},n=z.a.extend({},z.a.CRS.Simple,{projection:t,transformation:new z.a.Transformation(1,0,-1,0),scale:function(e){return Math.pow(2,e)}});this.map=z.a.map("map",{attributionControl:!1,crs:n,zoomControl:!1}).setView([0,0],Math.max(0,this.mapInfo.maxzoom-1)),z.a.control.zoom({position:"topright"}).addTo(this.map)},getClaims:function(e){return fetch("/api/getmapclaims?type=".concat(e)).then(function(e){return e?e.json():[]}).then(function(e){return e})},drawAllClaims:function(){var e=Object(y["a"])(regeneratorRuntime.mark(function e(){var t,n,a,r,o,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.colorIterator=0,t=!0,n=!1,a=void 0,e.prev=4,r=this.claimTypes[Symbol.iterator]();case 6:if(t=(o=r.next()).done){e.next=14;break}return i=o.value,e.next=10,this.drawClaim(i);case 10:this.colorIterator++;case 11:t=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](4),n=!0,a=e.t0;case 20:e.prev=20,e.prev=21,t||null==r.return||r.return();case 23:if(e.prev=23,!n){e.next=26;break}throw a;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return this.colorIterator=0,e.next=31,this.drawClaim("resetregion");case 31:case"end":return e.stop()}},e,this,[[4,16,20,28],[21,,23,27]])}));function t(){return e.apply(this,arguments)}return t}(),drawClaim:function(){var e=Object(y["a"])(regeneratorRuntime.mark(function e(t){var n,a,r,o,i,s,c,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getClaims(t);case 2:for(n=e.sent,a=[],r=!0,o=!1,i=void 0,e.prev=7,s=n[Symbol.iterator]();!(r=(c=s.next()).done);r=!0)l=c.value,a.push(this.createClaimRectangle(l,t));e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](7),o=!0,i=e.t0;case 15:e.prev=15,e.prev=16,r||null==s.return||s.return();case 18:if(e.prev=18,!o){e.next=21;break}throw i;case 21:return e.finish(18);case 22:return e.finish(15);case 23:this.layers[t]=new z.a.LayerGroup(a),this.layers[t].addTo(this.map);case 25:case"end":return e.stop()}},e,this,[[7,11,15,23],[16,,18,22]])}));function t(t){return e.apply(this,arguments)}return t}(),createClaimRectangle:function(e,t,n){var a=z.a.rectangle([[e.W,e.S],[e.E,e.N]],{color:n||this.activeColor,weight:1});if(t){var r=z.a.popup().setContent("Name: ".concat(e.Name," Type: ").concat(t," ").concat(e.Type));a.bindPopup(r)}return a},initLayers:function(){var e=Object(y["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.tileLayer=this.GetSdtdTileLayer(this.mapInfo),this.tileLayer.addTo(this.map),e.next=4,this.drawAllClaims();case 4:this.layers["Regions"]=this.getRegionLayer(this.mapInfo),z.a.control.layers(null,this.layers).addTo(this.map);case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),FormatRegionFileName:function(e){return"r."+e.lat+"."+e.lng+".7rg"},CoordToRegion:function(e){var t=Math.floor((e.lat+16777216)/this.mapInfo.regionsize-16777216/this.mapInfo.regionsize),n=Math.floor((e.lng+16777216)/this.mapInfo.regionsize-16777216/this.mapInfo.regionsize);return z.a.latLng(t,n)},getRegionLayer:function(e){var t=this,n=z.a.gridLayer({maxZoom:e.maxzoom+1,minZoom:0,maxNativeZoom:e.maxzoom+1,tileSize:e.tilesize});return n.createTile=function(n){var a=e.tilesize*Math.pow(2,e.maxzoom-n.z),r=n.x*a,o=(-1-n.y)*a,i=z.a.latLng(r,o),s=z.a.DomUtil.create("canvas","leaflet-tile");s.width=e.tilesize,s.height=e.tilesize;var c=s.getContext("2d");c.fillStyle="white",c.lineWidth=1,c.font="14px Arial",c.strokeStyle="black";var l=a/e.regionsize;if(l>=1){var u=0;while(u<e.tilesize)c.beginPath(),c.moveTo(u,0),c.lineTo(u,e.tilesize),c.stroke(),c.beginPath(),c.moveTo(0,u),c.lineTo(e.tilesize,u),c.stroke(),u+=e.tilesize/l;var m=t.CoordToRegion(i),d=t.FormatRegionFileName(m);c.lineWidth=4,c.strokeText(d,4,e.tilesize-5),c.fillText(d,4,e.tilesize-5)}else if(r%e.regionsize==0&&(c.beginPath(),c.moveTo(0,0),c.lineTo(0,e.tilesize),c.stroke()),o%e.regionsize==0&&(c.beginPath(),c.moveTo(0,e.tilesize),c.lineTo(e.tilesize,e.tilesize),c.stroke()),r%e.regionsize==0&&o%e.regionsize==0){var p=t.CoordToRegion(i),h=t.FormatRegionFileName(p);c.lineWidth=4,c.strokeText(h,4,e.tilesize-5),c.fillText(h,4,e.tilesize-5)}return s},n}}},I=R,$=(n("00ad"),Object(u["a"])(I,T,C,!1,null,"329b1f33",null)),A=$.exports,O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{ref:"settingsModal",attrs:{id:"server-settings",title:"Connection info",size:"lg"},on:{ok:e.onSubmit}},[n("div",{staticClass:"my-4"},[n("b-form-group",{attrs:{id:"input-group-1",label:"Admin user:","label-for":"input-1"}},[n("b-form-input",{attrs:{id:"input-1",placeholder:"user"},model:{value:e.form.adminUser,callback:function(t){e.$set(e.form,"adminUser",t)},expression:"form.adminUser"}})],1),n("b-form-group",{attrs:{id:"input-group-1",label:"Admin token:","label-for":"input-1"}},[n("b-form-input",{attrs:{id:"input-1",placeholder:"secret-token",type:"password"},model:{value:e.form.adminToken,callback:function(t){e.$set(e.form,"adminToken",t)},expression:"form.adminToken"}})],1)],1)])},j=[],H={mounted:function(){localStorage.connectionInfo&&(this.form=JSON.parse(localStorage.connectionInfo))},data:function(){return{form:{adminUser:"",adminToken:""},show:!0}},methods:{onSubmit:function(){localStorage.connectionInfo=JSON.stringify(this.form),me.$emit("connection-info",this.form)}}},N=H,P=(n("f918"),Object(u["a"])(N,O,j,!1,null,"cd33904e",null)),U=P.exports,E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{ref:"claimsModal",attrs:{id:"claims",title:"Claims",size:"xl"}},[n("b-button-group",[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"claim-creator",expression:"'claim-creator'"}],attrs:{variant:"success"}},[e._v("Create")]),n("b-button",{attrs:{variant:"danger"},on:{click:e.onDelete}},[e._v("Delete claim(s)")])],1),n("b-table",{attrs:{striped:"",hover:"",items:e.claims,borderless:e.borderless,small:e.small,selectable:"","select-mode":e.multi},on:{"row-selected":e.rowSelected}})],1),n("claim-creator",{attrs:{selectedArea:e.selectedArea,selectedRegions:e.selectedRegions}})],1)},Y=[],D={data:function(){return{mapInfo:{regionsize:512,chunksize:16,tilesize:128,maxzoom:4},selected:[],claims:[],commands:[],selectedArea:null,selectedRegions:[],claimTypes:window.claimTypes,connectionInfo:{ip:"",port:"",adminUser:"",adminToken:""}}},computed:{cpmPort:function(){return parseInt(this.connectionInfo.port)+1}},mounted:function(){var e=this;localStorage.connectionInfo&&(this.connectionInfo=JSON.parse(localStorage.connectionInfo)),this.getClaims(),me.$on("refresh-claims",function(){e.claims=[],e.getClaims()}),me.$on("area-selected",function(t){e.selectedArea=t}),me.$on("region-selected",function(t){e.selectedRegions=t}),me.$on("add-command",function(t){e.commands.push(t)})},methods:{FormatRegionFileName:function(e){return"r."+e.lat+"."+e.lng+".7rg"},CoordToRegion:function(e){var t=Math.floor((e.lat+16777216)/this.mapInfo.regionsize-16777216/this.mapInfo.regionsize),n=Math.floor((e.lng+16777216)/this.mapInfo.regionsize-16777216/this.mapInfo.regionsize);return z.a.latLng(t,n)},onDelete:function(){var e=Object(y["a"])(regeneratorRuntime.mark(function e(){var t,n,a,r,o,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(t=!0,n=!1,a=void 0,e.prev=3,r=this.selected[Symbol.iterator]();!(t=(o=r.next()).done);t=!0)i=o.value,"Reset region"===i["Claim type"]?me.$emit("add-command","mrr remove ".concat(i.Name)):me.$emit("add-command","ccc remove ".concat(i.Name));e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](3),n=!0,a=e.t0;case 11:e.prev=11,e.prev=12,t||null==r.return||r.return();case 14:if(e.prev=14,!n){e.next=17;break}throw a;case 17:return e.finish(14);case 18:return e.finish(11);case 19:case"end":return e.stop()}},e,this,[[3,7,11,19],[12,,14,18]])}));function t(){return e.apply(this,arguments)}return t}(),rowSelected:function(e){this.selected=e},getClaims:function(){var e=Object(y["a"])(regeneratorRuntime.mark(function e(){var t,n,a,r,o,i,s,c,l,u,m,d,p,h,f,v,g,b,y,x,w;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getClaimType("resetregion");case 2:t=e.sent,n=!0,a=!1,r=void 0,e.prev=6,o=this.claimTypes[Symbol.iterator]();case 8:if(n=(i=o.next()).done){e.next=35;break}return s=i.value,e.next=12,this.getClaimType(s);case 12:for(c=e.sent,l=!0,u=!1,m=void 0,e.prev=16,d=c[Symbol.iterator]();!(l=(p=d.next()).done);l=!0)h=p.value,h["Claim type"]=s,h.options=h.Type,delete h.Type,this.claims.push(h);e.next=24;break;case 20:e.prev=20,e.t0=e["catch"](16),u=!0,m=e.t0;case 24:e.prev=24,e.prev=25,l||null==d.return||d.return();case 27:if(e.prev=27,!u){e.next=30;break}throw m;case 30:return e.finish(27);case 31:return e.finish(24);case 32:n=!0,e.next=8;break;case 35:e.next=41;break;case 37:e.prev=37,e.t1=e["catch"](6),a=!0,r=e.t1;case 41:e.prev=41,e.prev=42,n||null==o.return||o.return();case 44:if(e.prev=44,!a){e.next=47;break}throw r;case 47:return e.finish(44);case 48:return e.finish(41);case 49:for(f=!0,v=!1,g=void 0,e.prev=52,b=t[Symbol.iterator]();!(f=(y=b.next()).done);f=!0)x=y.value,w=this.CoordToRegion({lat:(x.W+x.E)/2,lng:(x.N+x.S)/2}),x.Name=this.FormatRegionFileName(w),x["Claim type"]="Reset region",this.claims.push(x);e.next=60;break;case 56:e.prev=56,e.t2=e["catch"](52),v=!0,g=e.t2;case 60:e.prev=60,e.prev=61,f||null==b.return||b.return();case 63:if(e.prev=63,!v){e.next=66;break}throw g;case 66:return e.finish(63);case 67:return e.finish(60);case 68:case"end":return e.stop()}},e,this,[[6,37,41,49],[16,20,24,32],[25,,27,31],[42,,44,48],[52,56,60,68],[61,,63,67]])}));function t(){return e.apply(this,arguments)}return t}(),getClaimType:function(e){return fetch("/api/getmapclaims?type=".concat(e)).then(function(e){return e?e.json():[]}).then(function(e){return e})}}},Z=D,F=Object(u["a"])(Z,E,Y,!1,null,"47494a97",null),W=F.exports,J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{ref:"claimCreator",attrs:{id:"claim-creator",title:"Create a claim",size:"lg"},on:{ok:e.createClaim}},[null===e.selectedArea&&e.selectedRegions.length<1?n("div",[n("b-alert",{attrs:{variant:"warning",show:""}},[e._v("You must select an area on the map first!")])],1):e._e(),null!==e.selectedArea&&this.area<1?n("div",[n("b-alert",{attrs:{variant:"warning",show:""}},[e._v("You must select an area that is atleast 3x3 blocks big!")])],1):e._e(),null!==e.selectedArea&&this.area>1?n("div",[n("div",[n("div",[e._v("\n        You are creating a claim that is\n        "),n("strong",[e._v(e._s(this.area))]),e._v(" blocks big.\n      ")]),n("div",[e._v("\n        The current command is:\n        "),n("div",[n("em",[e._v(e._s(e.command))])])]),n("hr"),n("label",{attrs:{for:"name"}},[e._v("Name")]),n("b-form-input",{attrs:{id:"name"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("label",{attrs:{for:"claim-accessLevel"}},[e._v("Accesslevel")]),n("b-form-input",{attrs:{type:"number",placeholder:"0"},model:{value:e.accessLevel,callback:function(t){e.accessLevel=t},expression:"accessLevel"}}),n("label",{attrs:{for:"type-select"}},[e._v("The type of claim. This will control its behaviour")]),n("b-form-select",{attrs:{id:"type-select",options:e.claimTypes},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}}),"leveled"===e.type?n("div",[n("p",[e._v("This is a normal claim, but with the option to level the upper and lower boundary of a claim. A normal claim reaches from bedrock to heaven. This claim has height and depth. Designed for protecting underground bases (with a normal claim, players walking on ground above the base would get tp'd out without knowing what they intruded) or for bases that have public tunnels under them (with a normal claim, players wouldnt be able to use the tunnel under the protected base).")]),n("label",{attrs:{for:"ycoordHigh"}},[e._v("Y coordinate top")]),n("b-form-input",{attrs:{id:"ycoordHigh",placeholder:"120",type:e.number},model:{value:e.options.yCoordHigh,callback:function(t){e.$set(e.options,"yCoordHigh",t)},expression:"options.yCoordHigh"}}),n("label",{attrs:{for:"ycoordLow"}},[e._v("Y coordinate bottom")]),n("b-form-input",{attrs:{id:"ycoordLow",placeholder:"40",type:e.number},model:{value:e.options.yCoordLow,callback:function(t){e.$set(e.options,"yCoordLow",t)},expression:"options.yCoordLow"}})],1):e._e(),"notify"===e.type?n("div",[n("p",[e._v("This claim defines a zone in which players get a configurable message in chat when they enter or exit the claim.")]),n("label",{attrs:{for:"enteringText"}},[e._v("Entering text")]),n("b-form-input",{attrs:{id:"enteringText",placeholder:"You are entering a claim",type:e.text,required:""},model:{value:e.options.enteringText,callback:function(t){e.$set(e.options,"enteringText",t)},expression:"options.enteringText"}}),n("label",{attrs:{for:"exitingText"}},[e._v("Exiting text")]),n("b-form-input",{attrs:{id:"exitingText",placeholder:"You are exiting a claim",type:e.text,required:""},model:{value:e.options.exitingText,callback:function(t){e.$set(e.options,"exitingText",t)},expression:"options.exitingText"}})],1):e._e(),"openhours"===e.type?n("div",[n("p",[e._v("This is a normal claim, but with assigned opening hours. Tired of your lobby or central tradingstation getting abused/wrecked by players for surviving (horde) night? Just set it to opening hours 0400 to 2200 and players will get tp'd out if they enter the area outside that hours.")]),n("label",{attrs:{for:"openingHour"}},[e._v("Opening hour")]),n("b-form-input",{attrs:{id:"openingHour",type:e.number},model:{value:e.options.openingHour,callback:function(t){e.$set(e.options,"openingHour",t)},expression:"options.openingHour"}}),n("label",{attrs:{for:"closingHour"}},[e._v("Closing hour")]),n("b-form-input",{attrs:{id:"closingHour",type:e.number},model:{value:e.options.closingHour,callback:function(t){e.$set(e.options,"closingHour",t)},expression:"options.closingHour"}})],1):e._e(),"portal"===e.type?n("div",[n("p",[e._v("Define an area and a triggerheight and an allowed player will get tp'd to a preset location.")]),n("label",{attrs:{for:"stepheight"}},[e._v("Stepheight")]),n("b-form-input",{attrs:{id:"stepheight",type:e.number},model:{value:e.options.stepheight,callback:function(t){e.$set(e.options,"stepheight",t)},expression:"options.stepheight"}}),n("h3",[e._v("Teleport destination")]),n("label",{attrs:{for:"portalX"}},[e._v("X coordinate")]),n("b-form-input",{attrs:{id:"portalX",type:e.number},model:{value:e.options.portalX,callback:function(t){e.$set(e.options,"portalX",t)},expression:"options.portalX"}}),n("label",{attrs:{for:"portalY"}},[e._v("Y coordinate")]),n("b-form-input",{attrs:{id:"portalY",type:e.number},model:{value:e.options.portalY,callback:function(t){e.$set(e.options,"portalY",t)},expression:"options.portalY"}}),n("label",{attrs:{for:"portalZ"}},[e._v("Z coordinate")]),n("b-form-input",{attrs:{id:"portalZ",type:e.number},model:{value:e.options.portalZ,callback:function(t){e.$set(e.options,"portalZ",t)},expression:"options.portalZ"}})],1):e._e(),"reversed"===e.type?n("div",[n("p",[e._v("Create an area for locking players in (aka jail). When whitelisted for a reversed claim, a player cannot leave the area and will get tp'd back in if he/she tries.")])]):e._e(),"hostilefree"===e.type?n("div",[n("p",[e._v("This is used for creating hostilefree area's. All hostiles will despawn in this type of advanced claim..")])]):e._e(),"timed"===e.type?n("div",[n("p",[e._v("Create an area for protecting bases/structures. Players not on whitelist of the claim will get tp'd out. This claim type has a time to live (hours). After the time has passed this claim will vanish.")]),n("label",{attrs:{for:"timeToLive"}},[e._v("Hours before claims vanishes")]),n("b-form-input",{attrs:{id:"timeToLive",type:e.number},model:{value:e.options.timeToLive,callback:function(t){e.$set(e.options,"timeToLive",t)},expression:"options.timeToLive"}})],1):e._e(),"command"===e.type?n("div",[n("p",[e._v("Trigger one or multiple console commands when a player enter this claim area. The claim type must be enclosed in double quotes and parameters with spaces within each command must be enclosed in single quotes. Use semicolon ( ; ) to seperate commands.")]),n("label",{attrs:{for:"command"}},[e._v("Command to execute")]),n("b-form-input",{attrs:{id:"command"},model:{value:e.options.command,callback:function(t){e.$set(e.options,"command",t)},expression:"options.command"}})],1):e._e(),"playerlevel"===e.type?n("div",[n("p",[e._v("This claim can be used to restrict/grant access to a claim by player level. Built in basic logical expression, plus support for level ranges.")]),n("label",{attrs:{for:"playerLevelCheck"}},[e._v("Operator check")]),n("b-form-input",{attrs:{id:"playerLevelCheck"},model:{value:e.options.playerLevelCheck,callback:function(t){e.$set(e.options,"playerLevelCheck",t)},expression:"options.playerLevelCheck"}})],1):e._e(),"lcbfree"===e.type?n("div",[n("p",[e._v("Control abillity to place LCB's within the boundaries of the lcbfree adv. claim. Allow to place LCB's by accesslevel and/or whitelist. If not allowed to place LCB, it will be removed and put back in player inventory. .")])]):e._e()],1)]):e._e(),e.selectedRegions.length>0?n("div",[n("div",[e._v("You have selected "+e._s(e.selectedRegions.length)+" regions.")]),n("ul",{attrs:{id:"reset-regions"}},e._l(e.selectedRegions,function(t,a){return n("li",{key:"region-"+a},[e._v(e._s(t))])}),0)]):e._e()])},X=[],q={data:function(){return{claimTypes:window.claimTypes,name:"My_cool_new_claim",type:null,options:{yCoordHigh:120,yCoordLow:40,enteringText:"You are entering a claim",exitingText:"You are exiting a claim",openingHour:"9",closingHour:"17",stepheight:64,portalX:50,portalY:0,portalZ:-80,timeToLive:12,command:"say 'Welcome ${playerName} to the claim!'",playerLevelCheck:"<=20"},accessLevel:0}},props:["selectedArea","selectedRegions"],computed:{area:function(){var e=Math.abs(this.selectedArea[0].lat-this.selectedArea[1].lat),t=Math.abs(this.selectedArea[0].lng-this.selectedArea[1].lng);return Math.round(2*(e+t))},command:function(){var e="ccc add ".concat(this.name," ").concat(this.getW()," ").concat(this.getE()," ").concat(this.getN()," ").concat(this.getS()," ").concat(this.accessLevel," ");switch(this.type){case"normal":break;case"hostilefree":e+="".concat(this.type);break;case"leveled":e+='"'.concat(this.type,":").concat(this.options.yCoordHigh,",").concat(this.options.yCoordLow,'"');break;case"notify":e+='"'.concat(this.type,":").concat(this.options.enteringText,":").concat(this.options.exitingText,'"');break;case"openhours":e+='"'.concat(this.type,":").concat(this.options.openingHour,"-").concat(this.options.closingHour,'"');break;case"portal":e+='"'.concat(this.type,":").concat(Math.round(this.options.stepheight),":").concat(Math.round(this.options.portalX),",").concat(Math.round(this.options.portalY),",").concat(Math.round(this.options.portalZ),'"');break;case"reversed":e+="".concat(this.type);break;case"timed":e+="".concat(this.type,":").concat(this.options.timeToLive);break;case"command":e+='"'.concat(this.type,":").concat(this.options.command,'"');break;case"lcbfree":e+="".concat(this.type);break;case"playerlevel":e+='"'.concat(this.type,":").concat(this.options.playerLevelCheck,'"');break;default:break}return e}},methods:{createClaim:function(){if(this.selectedArea&&me.$emit("add-command",this.command),this.selectedRegions.length){var e=!0,t=!1,n=void 0;try{for(var a,r=this.selectedRegions[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var o=a.value;me.$emit("add-command","mrr add ".concat(o))}}catch(i){t=!0,n=i}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}},getW:function(){return Math.round(Math.min(this.selectedArea[0].lat,this.selectedArea[1].lat))},getE:function(){return Math.round(Math.max(this.selectedArea[0].lat,this.selectedArea[1].lat))},getN:function(){return Math.round(Math.max(this.selectedArea[0].lng,this.selectedArea[1].lng))},getS:function(){return Math.round(Math.min(this.selectedArea[0].lng,this.selectedArea[1].lng))}}},B=q,G=Object(u["a"])(B,J,X,!1,null,null,null),V=G.exports,K=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{id:"commands",title:"Commands",size:"lg"}},[e.executing?n("div",[n("b-progress",{attrs:{value:e.executed,max:e.commands.length,"show-progress":"",animated:""}})],1):e._e(),e.commands.length>0?n("div",[n("b-button",{staticClass:"mx-auto",attrs:{variant:"success",size:"lg"},on:{click:e.execute}},[e._v("Execute "+e._s(e.commands.length)+" command"+e._s(e.commands.length>1?"s":""))]),n("ul",e._l(e.commands,function(t,a){return n("li",{key:"command-"+a},[n("b-button",{attrs:{variant:"danger"},on:{click:function(t){return e.deleteCommand(a)}}},[n("font-awesome-icon",{attrs:{icon:"trash-alt",size:"xs"}}),e._v("Delete\n          ")],1),e._v("\n          "+e._s(t)+"\n        ")],1)}),0),n("hr")],1):n("div",[n("p",[e._v("There are no commands in the queue yet. Create or delete some claims first!")])]),n("hr"),n("h3",[e._v("History")]),n("div",[n("ul",e._l(e.history,function(t,a){return n("span",{key:"history-"+a,class:{"text-danger":!t.success,"text-success":t.success}},[n("li",{attrs:{id:e.generateId(t)}},[e._v(e._s(e.formatDate(t.date))+" - "+e._s(t.command))]),n("b-tooltip",{attrs:{target:e.generateId(t),placement:"left"}},[e._v(e._s(t.statusText))])],1)}),0)])])],1)},Q=[],ee=(n("5df3"),n("4f7f"),n("75fc")),te=(n("a481"),{data:function(){return{commands:[],connectionInfo:{ip:"",port:"",adminUser:"",adminToken:""},history:[],executing:!1,executed:0}},methods:{generateId:function(e){return"".concat(e.date,"-").concat(e.command.replace("","-"))},formatDate:function(e){var t=new Date(e);return t.toLocaleString()},getHistory:function(){var e=localStorage.commandHistory;return e=e?JSON.parse(e):[],this.history=e,e},setHistory:function(e){this.history=e,localStorage.setItem("commandHistory",JSON.stringify(this.history))},addToHistory:function(e){var t=this.getHistory();t.unshift(e),this.setHistory(t)},deleteCommand:function(e){this.commands.splice(e,1),me.$emit("set-commands",this.commands.length)},execute:function(){var e=Object(y["a"])(regeneratorRuntime.mark(function e(){var t,n,a,r,o,i,s=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.executing=!0,t=!0,n=!1,a=void 0,e.prev=4,r=regeneratorRuntime.mark(function e(){var t,n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=i.value,e.next=3,fetch("/api/createadvclaim?command=".concat(t));case 3:n=e.sent,a={success:n.ok,command:t,statusText:n.statusText,date:Date.now()},s.commands=s.commands.filter(function(e){return e!==t}),s.addToHistory(a),s.executed++;case 8:case"end":return e.stop()}},e)}),o=this.commands[Symbol.iterator]();case 7:if(t=(i=o.next()).done){e.next=12;break}return e.delegateYield(r(),"t0",9);case 9:t=!0,e.next=7;break;case 12:e.next=18;break;case 14:e.prev=14,e.t1=e["catch"](4),n=!0,a=e.t1;case 18:e.prev=18,e.prev=19,t||null==o.return||o.return();case 21:if(e.prev=21,!n){e.next=24;break}throw a;case 24:return e.finish(21);case 25:return e.finish(18);case 26:me.$emit("set-commands",this.commands.length),me.$emit("refresh-claims"),this.executing=!1,this.executed=0;case 30:case"end":return e.stop()}},e,this,[[4,14,18,26],[19,,21,25]])}));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){var e=this;localStorage.connectionInfo&&(this.connectionInfo=JSON.parse(localStorage.connectionInfo)),this.getHistory(),me.$on("connection-info",function(t){e.connectionInfo=t}),me.$on("add-command",function(t){e.commands.push(t),e.commands=Object(ee["a"])(new Set(e.commands)),e.$bvToast.toast(t,{title:"A command was added to the queue"}),me.$emit("set-commands",e.commands.length)})}}),ne=te,ae=(n("276b"),Object(u["a"])(ne,K,Q,!1,null,"4e4b4b6e",null)),re=ae.exports,oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"session"},[e.userStatus.loggedin?n("div",[e._v("\n    "+e._s(this.userStatus.username)+" - Permission level: "+e._s(this.userStatus.permissionlevel)+"\n    "),n("br"),e._m(0)]):n("a",{attrs:{href:"/session/login"}},[n("img",{attrs:{src:"img/steamlogin.png"}})])])},ie=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"/session/logout"}},[n("button",{staticClass:"btn btn-danger",attrs:{type:"button"}},[e._v("Logout")])])}],se={name:"SessionHandler",data:function(){return{userStatus:{loggedin:!1,username:null,permissionlevel:2e3,permissions:[]}}},mounted:function(){var e=Object(y["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getUserStatus();case 2:this.userStatus=e.sent;case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{getUserStatus:function(){return fetch("/userstatus").then(function(e){return e.json()}).then(function(e){return e})}}},ce=se,le=(n("67b5"),Object(u["a"])(ce,oe,ie,!1,null,"3fcba173",null)),ue=le.exports;n.d(t,"eventBus",function(){return me}),n("6cc5"),window.claimTypes=["hostilefree","notify","command","leveled","reversed","normal","timed","portal","openhours","playerlevel","lcbfree"],window.allocsMap={host:location.hostname,port:parseInt(location.port)-1,protocol:location.protocol},p["c"].add(h["e"]),p["c"].add(h["h"]),p["c"].add(h["b"]),p["c"].add(h["i"]),p["c"].add(h["d"]),p["c"].add(h["c"]),p["c"].add(h["g"]),p["c"].add(h["f"]),p["c"].add(h["a"]),a["default"].component("font-awesome-icon",f["a"]),a["default"].component("sidebar",_),a["default"].component("sdtd-map",A),a["default"].component("server-settings",U),a["default"].component("claims",W),a["default"].component("claim-creator",V),a["default"].component("commands-modal",re),a["default"].component("session-handler",ue),a["default"].use(v["a"]),a["default"].use(o.a),a["default"].config.productionTip=!1;var me=new a["default"];new a["default"]({render:function(e){return e(d)}}).$mount("#app")},"64a9":function(e,t,n){},"67b5":function(e,t,n){"use strict";var a=n("239c"),r=n.n(a);r.a},"910d":function(e,t,n){},"9c96":function(e,t,n){},f918:function(e,t,n){"use strict";var a=n("0a93"),r=n.n(a);r.a}});
//# sourceMappingURL=app.164f3376.js.map